{
  "hash": "e211dcc3b35dfcdc0c197ec706544529",
  "result": {
    "markdown": "---\ntitle: \"Fitting gradient models\"\n---\n\n\n::: {.callout-note appearance=\"simple\"}\nThis is a work in progress that is currently undergoing heavy technical editing and copy-editing\n:::\n\n\n::: {.cell hash='spatial-fitting_cache/html/unnamed-chunk-1_4f7e3dd1d8ed09302349b900db5ef7c9'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ntheme_set(theme_gray(base_size = 16)) # set global theme\n```\n:::\n\n\n## Dataset\n\nThe hypothetical data below shows a gradient for the number of lesions counted at varying distances in meters from the source. Let's create two vectors, one for the distances $x$ and the other for the lesion count $Y$, and then a data frame by combining the two vectors.\n\n\n::: {.cell hash='spatial-fitting_cache/html/unnamed-chunk-2_ecd07d6541b055b7a748dabb86f8f497'}\n\n```{.r .cell-code}\n# create the two vectors\nx <- c(0.8, 1.6, 2.4, 3.2, 4, 7.2, 12, 15.2, 21.6, 28.8)\nY <- c(184.9, 113.3, 113.3, 64.1, 25, 8, 4.3, 2.5, 1, 0.8)\ngrad1 <- data.frame(x, Y) # create the dataframe\ngrad1 # show the gradient\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      x     Y\n1   0.8 184.9\n2   1.6 113.3\n3   2.4 113.3\n4   3.2  64.1\n5   4.0  25.0\n6   7.2   8.0\n7  12.0   4.3\n8  15.2   2.5\n9  21.6   1.0\n10 28.8   0.8\n```\n:::\n:::\n\n\n## Visualize the gradient\n\n\n::: {.cell hash='spatial-fitting_cache/html/fig-fit_grad1_3d0b0a09f6caaec86c1983bc506c02cb'}\n\n```{.r .cell-code}\ngrad1 |> \n  ggplot(aes(x, Y))+\n  theme_grey(base_size = 16)+\n  geom_point(size = 2)+\n  geom_line()+\n  labs(y = \"Lesion count\",\n       x = \"Distance (m)\")\n```\n\n::: {.cell-output-display}\n![Hypothetical gradient of lesion count over distances from the inoculum source](spatial-fitting_files/figure-html/fig-fit_grad1-1.png){#fig-fit_grad1 width=672}\n:::\n:::\n\n\n## Linear regression\n\nA linear regression model is fitted to the transformed variables according to the model. The higher the coefficient of determination, the better is the fit of the model to the data.\n\n### Exponential model\n\n\n::: {.cell hash='spatial-fitting_cache/html/unnamed-chunk-4_deae337636ff664cb53584fc80bc5a46'}\n\n```{.r .cell-code}\nreg_exp <- lm(log(Y) ~ x, data = grad1)\nsummary(reg_exp)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8776612\n```\n:::\n:::\n\n::: {.cell hash='spatial-fitting_cache/html/fig-fit_grad2_3f6bd2529d78a122c1fb8959edf47702'}\n\n```{.r .cell-code}\ngrad1 |> \n  ggplot(aes(x, log(Y)))+\n  theme_grey(base_size = 16)+\n  geom_point(size = 2)+\n  geom_line()+\n  geom_abline(slope = coef(reg_exp)[[2]], intercept = coef(reg_exp)[[1]])+\n labs(y = \"Log of Lesion count\",\n       x = \"Distance (m)\")\n```\n\n::: {.cell-output-display}\n![Fit of the exponential model to the log of lesion count over distances from the inoculum source](spatial-fitting_files/figure-html/fig-fit_grad2-1.png){#fig-fit_grad2 width=672}\n:::\n:::\n\n\n### Power law model \n\n\n::: {.cell hash='spatial-fitting_cache/html/unnamed-chunk-6_63d10f042dabe1761ef34f82fc618fc1'}\n\n```{.r .cell-code}\nreg_p <- lm(log(Y) ~ log(x), data = grad1)\nsummary(reg_p)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.962132\n```\n:::\n:::\n\n::: {.cell hash='spatial-fitting_cache/html/fig-fit_grad3_6292cffdc582423bfa84bc3ebd25e5ff'}\n\n```{.r .cell-code}\ngrad1 |> \n  ggplot(aes(log(x), log(Y)))+\n  theme_grey(base_size = 16)+\n  geom_point(size = 2)+\n  geom_line()+\n  geom_abline(slope = coef(reg_p)[[2]], intercept = coef(reg_p)[[1]])+\n labs(y = \"Log of Lesion count\",\n       x = \"Log of distance\")\n```\n\n::: {.cell-output-display}\n![Fit of the power law model to the log of lesion count over log of the distance from the inoculum source](spatial-fitting_files/figure-html/fig-fit_grad3-1.png){#fig-fit_grad3 width=672}\n:::\n:::\n\n\n### Modified power law model\n\n\n::: {.cell hash='spatial-fitting_cache/html/unnamed-chunk-8_95dedaff64c7e58373b769254f8deaf0'}\n\n```{.r .cell-code}\nreg_pm <- lm(log(Y) ~ log(x + 0.4), data = grad1)\nsummary(reg_pm)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9742072\n```\n:::\n:::\n\n::: {.cell hash='spatial-fitting_cache/html/fig-fit_grad4_c781670d198e93d2026d2568940b3088'}\n\n```{.r .cell-code}\ngrad1 |> \n  ggplot(aes(log(x+0.4), log(Y)))+\n  theme_grey(base_size = 16)+\n  geom_point(size = 2)+\n  geom_line()+\n  geom_abline(slope = coef(reg_pm)[[2]], intercept = coef(reg_pm)[[1]])+\n labs(y = \"Log of Lesion count\",\n       x = \"Log of distance + 0.4 (m)\")\n```\n\n::: {.cell-output-display}\n![Fit of the modified power law model to the log of lesion count over log + 0.4 of the distances from the inoculum source](spatial-fitting_files/figure-html/fig-fit_grad4-1.png){#fig-fit_grad4 width=672}\n:::\n:::\n\n\nBased on the (highest) coefficient of determination, the modified power law provided the best fit. The graphs for the fitted models confirm this conclusion.\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}